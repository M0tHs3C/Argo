import urllib.error, urllib.request, os, sys, requests
from host import host
class energySentinel:
    def energySentinelDefaultCreds(self):
        data = {'type': '6', 'username': 'admin', 'password': 'admin'}
        path = os.path.abspath(os.path.dirname(sys.argv[0]))
        vulnerable_host = open(path + '/host/up_host.txt', 'r').read().splitlines()
        a = 0
        while a < len(vulnerable_host):
            try:
                res = vulnerable_host[a]
                address = host.Host.addressRegex(res)
                url = "http://" + address['ip'] + ":" + str(address['port']) + "/loginServlet.do"
                r = requests.post(url, data=data)
                if 'email' in r.text:
                    print("[#] Found " + url + " with admin:admin as credentials")
            except:
                pass
            a += 1
